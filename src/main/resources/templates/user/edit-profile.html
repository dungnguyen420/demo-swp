<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" th:href="@{/style.css}">

    <title>Chỉnh sửa thông tin</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<style>
    .edit-card {
        max-width: 700px;
        margin: auto;
        box-shadow: 0 0 10px rgba(0,0,0,0.1);
        border-radius: 12px;
    }
    .avatar {
        width: 120px;
        height: 120px;
        border-radius: 50%;
        object-fit: cover;
        border: 3px solid #007bff;
        margin-bottom: 10px;
    }
</style>
<body class="container mt-4">

<h2>Chỉnh sửa thông tin cá nhân</h2>

<header class="navbar">
    <a th:href="@{/home}" class="logo">GymCare</a>
    <nav>
        <ul>
            <li><a th:href="@{/home}">Trang chủ</a></li>
            <li><a th:href="@{/package}">Gói tập</a></li>
            <li><a th:href="@{/trainers}">Huấn luyện viên</a></li>
            <li><a th:href="@{/classes}">Lớp học</a></li>
            <li><a th:href="@{/shop}">Cửa hàng</a></li>

            <li sec:authorize="hasRole('MANAGER')">
                <a th:href="@{/products/list}">Danh sách sản phẩm</a>
            </li>
        </ul>
    </nav>
    <div class="auth-section">
        <div sec:authorize="isAuthenticated()" class="profile-dropdown">
            <img th:src="@{/images/default-avatar.png}" alt="Avatar">
            <span sec:authentication="principal.username">Username</span>
            <ul class="dropdown-menu">
                <li><a th:href="@{/user/profile}"><i class="fas fa-user-circle"></i> Hồ sơ cá nhân</a></li>
                <li sec:authorize="hasRole('ADMIN')">
                    <a th:href="@{/auth/dashBoard}"><i class="fas fa-cog"></i> Bảng điều khiển</a>
                </li>
                <li class="logout"><a th:href="@{/logout}"><i class="fas fa-sign-out-alt"></i> Đăng xuất</a></li>
            </ul>
        </div>
        <a sec:authorize="!isAuthenticated()" th:href="@{/login}" class="cta-button">Đăng nhập</a>
    </div>
</header>

<form th:action="@{/user/edit}" th:object="${user}" method="post" enctype="multipart/form-data" class="card p-4 edit-card">
    <div th:if="${error}" class="alert alert-danger" role="alert">
        <span th:text="${error}"></span>
    </div>


    <div class="text-center mb-3">
        <img th:src="${user.avatar != null ? user.avatar : '/images/default-avatar.png'}" alt="Avatar" class="avatar">
        <div class="mt-2">
            <label class="form-label">Cập nhật ảnh đại diện:</label>
            <input type="file" name="avatarFile" class="form-control">
        </div>
    </div>

    <div class="row">
        <div class="col-md-6 mb-3">
            <label class="form-label">Họ</label>
            <input type="text" th:field="*{firstName}" class="form-control"/>
        </div>
        <div class="col-md-6 mb-3">
            <label class="form-label">Tên</label>
            <input type="text" th:field="*{lastName}" class="form-control"/>
        </div>
    </div>

    <div class="mb-3">
        <label class="form-label">Tên đăng nhập</label>
        <input type="text" th:field="*{userName}" class="form-control" readonly/>
    </div>

    <div class="mb-3">
        <label class="form-label">Email</label>
        <input type="email" th:field="*{email}" class="form-control"/>
    </div>

    <div class="mb-3">
        <label class="form-label">Số điện thoại</label>
        <input type="text" th:field="*{phone}" class="form-control" placeholder="Nhập số điện thoại của bạn"/>
    </div>

    <div class="mb-3">
        <label>Ngày sinh</label>
        <input type="datetime-local" th:field="*{birthDate}" class="form-control"/>

    </div>

    <div class="mb-3">
        <label class="form-label">Giới tính</label>
        <select th:field="*{gender}" class="form-select">
            <option value="">-- Chọn giới tính --</option>
            <option value="MALE">Nam</option>
            <option value="FEMALE">Nữ</option>
        </select>
    </div>

    <div class="mb-3">
        <label class="form-label">Tiểu sử</label>
        <textarea th:field="*{bio}" class="form-control" rows="3" placeholder="Giới thiệu ngắn gọn về bản thân"></textarea>
    </div>

    <div class="mb-3">
        <label class="form-label">Mật khẩu mới (nếu muốn đổi)</label>
        <input type="password" th:field="*{password}" class="form-control" placeholder="Để trống nếu không đổi">
    </div>

    <button type="submit" class="btn btn-success">Lưu thay đổi</button>
    <a href="/user/profile" class="btn btn-secondary">Hủy</a>
</form>

</body>
</html>