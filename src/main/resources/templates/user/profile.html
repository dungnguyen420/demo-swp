<!DOCTYPE html>
<html lang="vi"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Thông tin cá nhân</title>

    <link rel="stylesheet" th:href="@{/style.css}">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
</head>

<style>
    /* 3. SỬA LỖI VỠ FONT */
    :root {
        --font-heading: 'Arial', sans-serif;
        --font-body: 'Arial', sans-serif;
    }
    body, input, select, button {
        font-family: var(--font-body, 'Arial', sans-serif);
    }
    h1, h2, h3, h4, h5, h6 {
        font-family: var(--font-heading, 'Arial', sans-serif);
    }

    /* 4. BỔ SUNG CSS CHO LAYOUT PROFILE */

    /* Thông báo (Alerts) */
    .alert {
        padding: 1rem 1.5rem; border-radius: 8px;
        margin-bottom: 2rem; font-weight: 700; border: 1px solid;
    }
    .alert-success {
        background-color: rgba(80, 255, 80, 0.1);
        border-color: #50ff50; color: #50ff50;
    }

    /* Bố cục 2 cột */
    .profile-layout {
        display: grid;
        grid-template-columns: 300px 1fr; /* Cột sidebar cố định | Cột nội dung co giãn */
        gap: 2rem;
    }

    /* Cột 1: Sidebar (Avatar, Tên, Nút) */
    .profile-sidebar {
        background: var(--secondary-bg, #1A1A1A);
        border: 1px solid var(--border-color, rgba(255,215,0,0.2));
        border-radius: var(--border-radius, 12px);
        padding: 2.5rem;
        text-align: center;
        /* Cho phép sidebar co dãn chiều cao */
        align-self: start;
    }
    .profile-avatar {
        width: 180px;
        height: 180px;
        border-radius: 50%;
        border: 5px solid var(--primary-color, #FFD700);
        box-shadow: 0 0 25px rgba(255, 215, 0, 0.3);
        margin-bottom: 1.5rem;
        object-fit: cover;
    }
    .profile-sidebar h3 {
        font-size: 1.8rem;
        font-weight: 700;
        color: var(--text-color, #fff);
    }
    .profile-sidebar .role {
        color: var(--primary-color, #FFD700);
        font-weight: 700;
        margin-bottom: 2rem;
        text-transform: uppercase;
    }
    .profile-sidebar .cta-button {
        width: 100%;
        justify-content: center; /* Căn giữa icon/text trong nút */
    }

    /* Cột 2: Chi tiết (Dùng style của form-card) */
    .profile-details {
        /* (style .form-card từ css/style.css sẽ áp dụng ở đây) */
        padding: 1.5rem 2.5rem; /* Tùy chỉnh padding */
    }
    .profile-details .detail-item {
        padding: 1.25rem 0;
        border-bottom: 1px solid var(--border-color, rgba(255,215,0,0.2));
        font-size: 1.1rem;
        color: var(--text-secondary, #ccc);
        /* Dùng flex để căn chỉnh */
        display: flex;
        flex-wrap: wrap; /* Xuống dòng nếu không đủ */
    }
    .profile-details .detail-item:last-child {
        border-bottom: none;
    }
    .profile-details .detail-item strong {
        color: var(--text-color, #fff);
        font-weight: 700;
        min-width: 180px; /* Đặt chiều rộng cố định cho nhãn */
    }
    .profile-details .detail-item.bio strong {
        width: 100%; /* Nhãn bio chiếm 1 hàng */
        margin-bottom: 0.5rem;
    }
    .profile-details .detail-item.bio p {
        width: 100%;
        line-height: 1.6;
        color: var(--text-secondary, #ccc);
    }

    /* Responsive cho điện thoại */
    @media (max-width: 768px) {
        .profile-layout {
            grid-template-columns: 1fr; /* Xếp chồng 2 cột */
        }
    }

</style>

<body>

<header class="navbar">
    <a th:href="@{/home}" class="logo">GymCare</a>
    <nav>
        <ul>
            <li><a th:href="@{/home}">Trang chủ</a></li>
            <li><a th:href="@{/package}" >Gói tập</a></li>
            <li><a th:href="@{/trainers}">Huấn luyện viên</a></li>
            <li><a th:href="@{/classes}">Lớp học</a></li>
            <li><a th:href="@{/shop}">Cửa hàng</a></li>
        </ul>
    </nav>
    <div class="auth-section">
        <div sec:authorize="isAuthenticated()" class="profile-dropdown">
            <img th:src="@{/images/default-avatar.png}" alt="Avatar">
            <span sec:authentication="principal.username">Username</span>
            <ul class="dropdown-menu">
                <li><a th:href="@{/user/profile}"><i class="fas fa-user-circle"></i> Hồ sơ cá nhân</a></li>
                <li sec:authorize="hasRole('ADMIN')">
                    <a th:href="@{/auth/dashBoard}"><i class="fas fa-user-shield"></i> Trang quản trị</a>
                </li>
                <li >
                    <a th:href="@{/my-schedule/personal}"><i class="fas fa-user"></i> Lịch PT của tôi</a>
                </li>
                <li >
                    <a th:href="@{/my-schedule/classes}"><i class="fas fa-users"></i> Lớp học của tôi</a>
                </li>
                <li sec:authorize="hasAuthority('TRAINER')">
                    <a th:href="@{/my-schedule/teaching}"><i class="fas fa-chalkboard-teacher"></i> Lịch dạy của tôi</a>
                </li>
                <li sec:authorize="hasRole('TRAINER')">
                    <a th:href="@{/auth/dashBoard}"><i class="fas fa-cog"></i> Bảng điều khiển</a>
                </li>
                <li><a th:href="@{/orders/history}"><i class="fas fa-history"></i> Lịch sử giao dịch</a></li>
                <li class="logout"><a th:href="@{/logout}"><i class="fas fa-sign-out-alt"></i> Đăng xuất</a></li>
            </ul>
        </div>
        <a sec:authorize="!isAuthenticated()" th:href="@{/index}" class="cta-button">Đăng nhập</a>
    </div>
</header>
<main class="page-container" style="max-width: 1000px;"> <h1 class="page-title">Thông tin cá nhân</h1>

    <div th:if="${param.success}" class="alert alert-success">
        Cập nhật thông tin thành công!
    </div>

    <div class="profile-layout">

        <div class="profile-sidebar">
            <img th:src="${user.avatar != null ? user.avatar : '/images/default-avatar.png'}"
                 alt="Avatar" class="profile-avatar">
            <h3 class="mt-2" th:text="${user.firstName + ' ' + user.lastName}">Tên người dùng</h3>
            <p class="role" th:text="${user.role}">ROLE_MEMBER</p>
            <a href="/user/edit" class="cta-button">Chỉnh sửa thông tin</a>
        </div>

        <div class="profile-details form-card">
            <div class="detail-item">
                <strong>Tên đăng nhập:</strong>
                <span th:text="${user.userName}">Username</span>
            </div>
            <div class="detail-item">
                <strong>Email:</strong>
                <span th:text="${user.email}">Email</span>
            </div>
            <div class="detail-item">
                <strong>Số điện thoại:</strong>
                <span th:text="${user.phone != null ? user.phone : 'Chưa cập nhật'}"></span>
            </div>
            <div class="detail-item">
                <strong>Ngày sinh:</strong>
                <span th:text="${user.birthDate != null ? #temporals.format(user.birthDate, 'dd/MM/yyyy') : 'Chưa cập nhật'}"></span>
            </div>
            <div class="detail-item">
                <strong>Giới tính:</strong>
                <span th:text="${user.gender != null ? user.gender : 'Chưa cập nhật'}"></span>
            </div>
            <div class="detail-item">
                <strong>Trạng thái:</strong>
                <span th:text="${user.status}"></span>
            </div>
            <div class="detail-item bio">
                <strong>Tiểu sử:</strong>
                <p th:text="${user.bio != null ? user.bio : 'Chưa có thông tin'}"></p>
            </div>
        </div>

    </div> </main> <footer class="site-footer">
    <div class="container"> <p>&copy; 2025 GymCare. Đã đăng ký bản quyền.</p>
    </div>
</footer>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        const profileDropdown = document.querySelector('.profile-dropdown');
        if (profileDropdown) {
            profileDropdown.addEventListener('click', (e) => {
                if (!e.target.closest('a')) {
                    e.preventDefault();
                    profileDropdown.classList.toggle('active');
                }
            });
            document.addEventListener('click', (e) => {
                if (profileDropdown && !profileDropdown.contains(e.target)) {
                    profileDropdown.classList.remove('active');
                }
            });
        }
    });
</script>

</body>
</html>